<ActionBar title="Title" class="action-bar bg-darkblue">
    <NavigationButton text="{{'Back' | L}}" android.systemIcon="ic_menu_back" (tap)="goBack()"></NavigationButton>
    <Label [text]="'MAP' | L" class="alarm-text"></Label>

</ActionBar>

<GridLayout [id]="'level_3_' + dataService.deviceData[idDevice].id" class="homeBackgroundImage"
            backgroundImage="~/assets/AppDesignSources_FreigestellteBilder_bg_harbour_gray.png">
    <StackLayout [id]="'level_4_' + dataService.deviceData[idDevice].id" (refresh)="refreshList($event)">
        <StackLayout [id]="'level_5_' + dataService.deviceData[idDevice].id" orientation="vertical" *ngIf="initialized">
            <StackLayout [id]="'level_6_' + dataService.deviceData[idDevice].id">
                <GridLayout columns="120, *" rows="30, 30" padding="5" marginBottom="10" class="bg-darkblue">
                    <GridLayout col="0" row="0" rowSpan="2" marginRight="12" *ngIf="dataService.deviceData[idDevice].boat_image_small && dataService.deviceData[idDevice].boat_image_small != 'null'">
                        <Image [src]="'' + dataService.deviceData[idDevice].boat_image_small"
                               class="boatoffice-boat-image"></Image>
                    </GridLayout>
                    <Label col="1" row="0" [text]="'Boat' | L" class="c-white t-16 font-weight-bold" height="30"></Label>
                    <Label col="1" row="1" [text]="dataService.deviceData[idDevice].name"
                           class="alarm-blue t-16" height="30"></Label>
                </GridLayout>
                <StackLayout orientation="horizontal" height="60">
                    <GridLayout
                            class="{{'interval-button' + (interval.id == selectedIntervalId ? '-selected' : '')}}" verticalAlignment="top" horizontalAlignment="center"
                            (tap)="setSelectedInterval(interval.id)" *ngFor="let interval of dataService.historyIntervalData">
                        <Label [text]="interval.name | L" verticalAlignment="middle" horizontalAlignment="center"></Label>
                    </GridLayout>
                </StackLayout>
                <StackLayout orientation="horizontal"
                             *ngIf="dataService.boatStatus[dataService.deviceData[idDevice].id].sensor_data.PosMessageSubstitute == true">
                    <GridLayout verticalAlignment="top" horizontalAlignment="center" padding="10">
                        <Label class="" textWrap="true" [text]="'bad_gps_reception_explained' | L" verticalAlignment="middle" horizontalAlignment="center"></Label>
                    </GridLayout>
                </StackLayout>
                <StackLayout orientation="vertical" padding="10" class="alarm-card t-18" [visibility]="selectedIntervalId > 0 && !dataService.deviceData[idDevice].is_pro ? 'visible' : 'collapsed'">
                    <TextView fontSize="18" text="{{'Please buy Pro' | L}}"></TextView>
                </StackLayout>
                <StackLayout [id]="'level_7_' + dataService.deviceData[idDevice].id" orientation="vertical" padding="0,0,0,0" backgroundColor="white" [visibility]="selectedIntervalId <= 0 || dataService.deviceData[idDevice].is_pro ? 'visible' : 'collapsed'">
                    <GridLayout [id]="'level_8_' + dataService.deviceData[idDevice].id" *ngIf="dataService.boatStatus[dataService.deviceData[idDevice].id].position_data.latitude != 0">
                        <MapView [id]="'mapview_' + dataService.deviceData[idDevice].id" #mapView [latitude]="dataService.boatStatus[dataService.deviceData[idDevice].id].position_data.latitude" [longitude]="dataService.boatStatus[dataService.deviceData[idDevice].id].position_data.longitude"
                                 [zoom]="zoom" [minZoom]="minZoom" [maxZoom]="maxZoom" [bearing]="bearing"
                                 [tilt]="tilt" i-padding="50,50,50,50" [padding]="padding" [mapAnimationsEnabled]="false"
                                 (mapReady)="onMapReady($event, idDevice)"
                                 (markerSelect)="onMarkerEvent($event)"
                                 (markerInfoWindowTapped)="onMarkerEvent($event)"></MapView>
                    </GridLayout>
                </StackLayout>
            </StackLayout>
        </StackLayout>
    </StackLayout>
</GridLayout>
